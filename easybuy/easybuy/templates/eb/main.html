<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EasyBuy{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'output.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playball&display=swap" rel="stylesheet">
</head>
</head>
<body>
    <header class=" bg-white sticky top-0 left-0 w-full z-50 border-b border-gray-200">
        <div class="flex justify-between bg-green-700 p-2 text-ivory">
            <div class="flex ml-4 font-semibold">
                <a href="http://" class="flex hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" />
                    </svg>                  
                    - (254) 742 532 606
                </a>
            </div>
            <div class="">
                <a href="http://" class="hover:underline">
                    <span class="font-bold">BLACK FRIDAY OFFERS!!!</span>
                </a>
            </div>
            <div class="mr-4">
                <a href="http://" class="hover:underline">Get 50% off items | Check offers</a>
            </div>
        </div>
        <nav class="flex justify-between">
            <div class="p-2">
                <h1 class=" font-playball text-5xl font-bold text-green-800 hover:text-green-600 cursor-pointer"><a href="{% url 'main' %}">EasyBuy</a></h1>
            </div>
            <div>
                <ul class="flex justify-between p-2">
                  {% for category in categories %}
                    <li class="hover:underline m-4 font-semibold text-gray-600">
                        <a href="{% url 'category_products' category.id %}">{{ category.name }}</a>
                    </li>
                  {% endfor %}
                </ul>
            </div>
            <div class="flex bg-slate-200 rounded-xl m-4 p-2">
              <form method="GET" action="{% url 'product_search' %}" class="flex">
                <input type="text" name="q" class="bg-slate-200 outline-none" placeholder="Search products..." value="{{ request.GET.q|default_if_none:'' }}">
                <button type="submit">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                  </svg> 
                </button>
              </form>
            </div>         
            <div class="flex p-2">
                <a href="http://" class="flex justify-between m-4 ">
                  {% if user.profile.image %}
                      <img  style="width: 30px; height: 30px;" class="w-4 h-4 m-0 rounded-full" src="{{ user.profile.image }}" alt="{{ user.username }}'s profile image">
                      {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mr-2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
                        </svg>
                      {% endif %}
                </a>
                <a href="http://" class="flex justify-between m-4 hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mr-2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" />
                    </svg>                      
                    <span class="font-semibold text-gray-600">Cart</span>
                </a>
            </div>
        </nav>
    </header>

    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer class="bg-ivory border-t border-gray-200 text-gray-700 py-10">
        <div class="max-w-screen-xl mx-auto px-4 md:px-8">
          <!-- Sitemap and Links -->
          <div class="flex flex-col md:flex-row justify-between mb-10">
            <!-- Sitemap Links Section -->
            <div class="mb-6 md:mb-0 md:w-1/4">
              <h4 class="text-lg font-semibold text-green-700 mb-4">Sitemap</h4>
              <ul class="space-y-2 text-gray-600">
                <li><a href="#" class="hover:text-green-500 transition">Electronics</a></li>
                <li><a href="#" class="hover:text-green-500 transition">Furniture</a></li>
                <li><a href="#" class="hover:text-green-500 transition">Food and Beverages</a></li>
                <li><a href="#" class="hover:text-green-500 transition">Clothing and Fashion</a></li>
              </ul>
            </div>
      
            <!-- Contact Information Section -->
            <div class="mb-6 md:mb-0 md:w-1/4">
              <h4 class="text-lg font-semibold text-green-700 mb-4">Contact Us</h4>
              <p class="text-gray-600 mb-1">Phone: (254) 742 532 606</p>
              <p class="text-gray-600 mb-1">Email: <a href="mailto:easybuy@company.com" class="hover:text-green-500 transition">easybuy@company.com</a></p>
              <p class="text-gray-600">Address: 123 Main Street, City, State</p>
            </div>
      
            <!-- Email Signup Form -->
            <div class="md:w-1/4">
              <h4 class="text-lg font-semibold text-green-700 mb-4">Stay Updated</h4>
              <form class="flex flex-col">
                <input type="email" placeholder="Your Email" class="p-2 mb-2 rounded text-gray-700 border border-gray-300 focus:border-green-500 focus:ring-0" required>
                <button type="submit" class="bg-green-600 text-white py-2 rounded hover:bg-green-700 transition">Sign Up</button>
              </form>
            </div>
      
            <!-- Social Media Links -->
            <div class="md:w-1/4 flex md:justify-end">
              <div class="text-center">
                <h4 class="text-lg font-semibold text-green-700 mb-4">Follow Us</h4>
                <div class="flex justify-center space-x-4">
                  <a href="#" class="text-gray-600 hover:text-green-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                      </svg>                      
                  </a>
                  <a href="#" class="text-gray-600 hover:text-green-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                      </svg>                      
                  </a>
                  <a href="#" class="text-gray-600 hover:text-green-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                      </svg>                      
                  </a>
                  <a href="#" class="text-gray-600 hover:text-green-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                      </svg>                      
                  </a>
                  <a href="#" class="text-gray-600 hover:text-green-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                      </svg>                      
                  </a>
                </div>
              </div>
            </div>
          </div>
      
          <!-- Legal and Copyright Information -->
          <div class="flex flex-col md:flex-row items-center justify-between border-t border-gray-200 pt-6">
            <p class="text-gray-600 text-sm">&copy; 2024 EasyBuy. All Rights Reserved.</p>
            <div class="flex space-x-4 mt-4 md:mt-0 text-sm">
              <a href="#" class="text-gray-600 hover:text-green-500 transition">Privacy Policy</a>
              <a href="#" class="text-gray-600 hover:text-green-500 transition">Terms of Service</a>
              <a href="#" class="text-gray-600 hover:text-green-500 transition">Cookie Policy</a>
            </div>
          </div>
        </div>
      </footer>
</body>
<script>
  function addToCart(productId) {
      fetch(`/add-to-cart/${productId}/`, {
          method: 'GET',
          headers: {
              'X-Requested-With': 'XMLHttpRequest'
          }
      })
      .then(response => response.json())
      .then(data => {
          document.getElementById('cart-count').innerText = data.total_items;
          alert("Item added to cart!");
      })
      .catch(error => console.error('Error:', error));
  }

  function addToCart(productId) {
    fetch(`/add-to-cart/${productId}/`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
        },
        body: JSON.stringify({
            'product_id': productId,
        }),
    })
    .then(response => response.json())
    .then(data => {
        if (data.error) {
            alert(data.error); // Show error if item is out of stock
        } else {
            // Update the cart item count dynamically
            document.getElementById('cart-item-count').innerText = data.total_items;
            alert(data.message); // Show success message
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

// Function to get the CSRF token from the cookie for the AJAX request
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
  </script>  
</html>
